---
title: "论文复现归纳文档"
format:
  html:
    toc: true
    toc-depth: 3
    number-sections: true
execute:
  echo: true
  warning: false
  error: false
  results: "markup"
---

# 复现准备说明

## 文献信息

**题目**：结婚对成年早期个体生活满意度发展轨迹的影响——基于中国家庭追踪调查的 10 年追踪  
**作者**：彭旺, 阎平, 周雅萍, 向燕辉  
**期刊**：心理学报 (2025)  
**数据来源**：CFPS 2010–2020 六期纵向数据（个体层面）  
**原始文件**：复现准备文档.docx  

---

## 研究问题与研究假设

| 研究问题 | 假设 |
|:--|:--|
| **结婚与生活满意度的关系** | H1：总体上，婚姻可以提升个体的生活满意度。<br>H2：婚姻可以通过增加积极情感、缓解消极症状来提升个体的生活满意度。 |
| **年龄阶段对结婚和生活满意度的影响** | H3：新兴成年早期（18～21 岁），婚姻无法显著提升个体生活满意度。<br>H4：新兴成年中期（22～25 岁）与晚期（26～29 岁），婚姻可以显著提升个体生活满意度。 |


---
## 核心变量说明
| 变量类别 | 变量 | 变量说明 |
|:--|:--|:--|
| **控制变量** | 性别 | 0 = 女性，1 = 男性 |
|  | 年龄 | 个体年龄 |
|  | 受教育水平 | “个人问卷受访者已完成的受教育年限” |
|  | 个人收入 | 个体在特定年份内所获取的收入总额 |
|  | 主观健康状况 | “认为自己的健康状况如何？” |
|  | 是否有工作 | “您现在有工作吗？”（0 = 没有，1 = 有） |
| **中介变量（CES-D 8）** | 积极情绪 | 2 个条目：“我感到愉快”、“我生活快乐” |
|  | 消极症状 | 6 个条目：“我感到情绪低落”、“我感到悲伤难过”、“我感到孤独”、“我觉得做任何事情都很费劲”、“我的睡眠不好”、“我觉得生活无法继续” |
| **自变量** | 婚姻状况 | “您的婚姻状况是？”（1 未婚，2 有配偶(在婚)，3 同居，4 离婚，5 丧偶）。剔除报告“离婚”或“丧偶”的个体后，对婚姻状况进行二分化处理。 |
|  | 结婚样本 | 在调查过程中经历过结婚事件并随后始终保持“在婚”状态的个体。 |
|  | 非婚样本（对照） | 在整个调查周期中始终处于“非婚”状态的个体（包含“未婚”和“同居”等未处于正式婚姻状态者）。 |


## 主要分析思路与可复现部分的初步实施计划
&emsp;&emsp;本次复现的重点在于 **数据处理与研究流程的再现**。  
&emsp;&emsp;核心目标是通过复现数据清洗、拼接与变量构建的过程，掌握纵向追踪数据的整理逻辑与可分析数据集的生成方法。

&emsp;&emsp;由于本次任务的主要目的在于熟悉数据处理流程而非完全复现文献结论，因此对原研究的工作进行了适当简化：

- 依据变量类型，选取具有代表性的变量进行处理；
- 仅完成 **两期数据（2016 与 2018）** 的拼接；
- 在分析阶段，仅进行 **简单的回归分析** 以验证数据处理正确性。

### 选取的代表性变量信息表

| 变量类型 | 变量名称 | 主要内容 / 含义 | 数据处理与说明 |
|:--|:--|:--|:--|
| **因变量** | 生活满意度水平 | 个体对生活总体满意程度的自评（Likert 量表） | 作为主要结果变量，反映婚姻与幸福感之间的关系。 |
| **控制变量** | 性别 | 0 = 女性，1 = 男性 | 统一编码并作为人口学控制项之一。 |
|  | 个人收入 | 个体在特定年份获得的年度总收入 | 按照 codebook 统一取值单位与缺失处理。 |
|  | 主观健康状况 | 自评健康水平（“认为自己的健康状况如何？”） | 对不同年份的变量取值进行统一映射。 |
| **中介变量** | 积极情绪 | CES-D 8 量表中两条积极情绪条目（“我感到愉快”、“我生活快乐”）的均值得分 | 用于探讨婚姻通过情绪途径影响生活满意度的中介机制。 |
| **自变量** | 结婚年龄 | 个体首次结婚时的年龄 | 根据结婚年份与出生年份计算。 |

---

# 数据来源与处理流程

## 数据来源与提取

&emsp;&emsp;从 CFPS 官网获取 **2010–2020 六期追踪数据**，提取涉及以下变量的个体层数据：

1. **核心研究变量**  
   - 婚姻状态  
   - 生活满意度  
   - 积极情绪与消极症状（CES-D 8 项）  

2. **人口学控制变量**  
   - 性别  
   - 年龄  
   - 受教育年限  
   - 收入  
   - 主观健康状况  
   - 是否有工作  

3. **时间变量**  
   - 调查年份  
   - 波次（survey wave）

---

## 样本筛选与处理规则

1. **研究对象限定**：选取年龄 **18–29 岁** 的个体。  
2. **婚姻状态筛选**：  
   - 剔除报告“离婚”或“丧偶”的个体；  
   - 保留“未婚”“同居”“在婚”个体；  
   - 根据婚姻状态变化划分：  
     - **事件组（结婚样本）**：在追踪期内经历结婚事件并保持“在婚”；  
     - **对照组（非婚个体）**：在追踪期内始终处于“非婚”状态（包括“未婚”和“同居”）。  

3. **关键变量构建**：  
   - 根据出生年月与婚姻变动时间计算：  
     - **结婚年龄**（首次结婚时年龄）；  
     - **事件时间轴变量**（以婚姻事件为时间零点，向前后延伸若干波次）。  
   - 例如：若个体出生于 1990 年 1 月，在 2016 年 1 月结婚，并于 2014 年 6 月与 2016 年 6 月参与调查，则其：  
     - 结婚年龄 = 26 岁；  
     - 对应的“婚姻事件时间轴”取值分别为 −19（月）与 +5（月）。

---

## 变量与数据处理说明

| 变量类型 | 变量名称 | 主要内容 / 含义 | 数据处理与说明 |
|:--|:--|:--|:--|
| **因变量** | 生活满意度水平 | 个体对生活总体满意程度的自评（Likert 量表） | 作为主要结果变量，反映婚姻与幸福感之间的关系。 |
| **控制变量** | 性别 | 0 = 女性，1 = 男性 | 统一编码并作为人口学控制项之一。 |
|  | 个人收入 | 个体在特定年份获得的年度总收入 | 按照 codebook 统一取值单位与缺失处理。 |
|  | 主观健康状况 | 自评健康水平（“认为自己的健康状况如何？”） | 对不同年份的变量取值进行统一映射。 |
| **中介变量** | 积极情绪 | CES-D 8 量表中两条积极情绪条目（“我感到愉快”、“我生活快乐”）的均值得分 | 用于探讨婚姻通过情绪途径影响生活满意度的中介机制。 |
| **自变量** | 结婚年龄 | 个体首次结婚时的年龄 | 根据结婚年份与出生年份计算。 |

---

## 数据处理流程

&emsp;&emsp;按照预设流程进行如下数据处理工作：

1. **变量统一**：依据 *codebook* 对不同年份的变量命名和取值进行统一。  
2. **数据拼接**：以个人 ID（`pid`）为键，完成 **2016–2018** 两期数据的合并。  
3. **缺失与异常处理**：删除或修正缺失值、异常值。  
4. **样本筛选**：选取符合条件（18–29 岁、婚姻状态有效）的样本。  
5. **数据输出**：生成可直接用于分析的两期 CFPS 面板数据集。


&emsp;&emsp;本次文献复现任务的整体思路如下：

1. **构建婚姻事件追踪数据集**  
   从 CFPS 多期数据中提取个体层面信息，建立“婚姻事件追踪数据集”，  
   重点呈现从原始 CFPS 数据到可分析样本的整理全过程。

2. **基础分析与结果呈现**  
   在生成的面板数据上进行基础的描述统计与简单回归分析，  
   用以验证数据整理过程的正确性，并初步观察婚姻与生活满意度的关系。

# 数据处理与分析

## 前置设置
```{python}
import pandas as pd
import numpy as np
import os
os.chdir("/Users/wangzining/Desktop/CFPS/person")
```

## 2016年数据处理
```{python}
df16 = pd.read_stata("cfps2016_person.dta",convert_categoricals=False)

# 重命名变量
df16 = df16.rename(columns={
    "cfps_gender": "sex_2016",
    "income": "total_income_2016",
    "qp201": "health_self_2016",
    "qn12012": "life_satisfaction_2016",
    "qea205y": "mage_y_2016",
    "qea205m": "mage_m_2016",
    "qea0": "marital_status_2016",
    "cfps_birthy": "birth_y_2016",
    "pn412": "pos_emo_1",
    "pn416": "pos_emo_2"
})

# 构造积极情绪变量（文献中未列出具体计算公式，此处暂且采用均值计算分数）
df16["pos_emo_2016"] = df16[["pos_emo_1", "pos_emo_2"]].mean(axis=1)

# 保留所需变量
keep_vars_16 = [
    "pid", "sex_2016", "total_income_2016", "health_self_2016", "pos_emo_2016",
    "life_satisfaction_2016", "mage_y_2016", "mage_m_2016",
    "marital_status_2016", "birth_y_2016"
]
df16 = df16[keep_vars_16]

# 保存为中间文件
df16.to_stata("cfps2016_core.dta", write_index=False)
```

## 2018年数据处理
```{python}
df18 = pd.read_stata("cfps2018_person.dta",convert_categoricals=False)

# 重命名变量
df18 = df18.rename(columns={
    "gender_update": "sex_2018",
    "qg12": "total_income_2018",
    "qp201": "health_self_2018",
    "qn12012": "life_satisfaction_2018",
    "qea205y": "mage_y_2018",
    "qea205m": "mage_m_2018",
    "qea0": "marital_status_2018",
    "qa001y": "birth_y_2018",
    "qa001m": "birth_m_2018",
    "qn412": "pos_emo_1",
    "qn416": "pos_emo_2"
})

# 构造积极情绪变量
df18["pos_emo_2018"] = df18[["pos_emo_1", "pos_emo_2"]].mean(axis=1)

# 保留所需变量
keep_vars_18 = [
    "pid", "sex_2018", "total_income_2018", "health_self_2018", "pos_emo_2018",
    "life_satisfaction_2018", "mage_y_2018", "mage_m_2018",
    "marital_status_2018", "birth_y_2018", "birth_m_2018"
]
df18 = df18[keep_vars_18]

# 保存为中间文件
df18.to_stata("cfps2018_core.dta", write_index=False)
```

## 数据集合并
```{python}
panel = pd.merge(df16, df18, on="pid", how="inner")

# 保存合并结果
panel.to_stata("/Users/wangzining/Desktop/CFPS/person/cfps_panel_2016_2018.dta", write_index=False)

# 缺失值替换
panel = panel.applymap(lambda x: np.nan if isinstance(x, (int, float)) and x < 0 else x)

# 出生年份与年龄计算
panel = panel.rename(columns={"birth_y_2016": "birthy2016", "birth_y_2018": "birthy2018"})
panel["birth"] = panel["birthy2016"]

# 如果2018年出生年份不为空且不同，则替换
panel.loc[(~panel["birthy2018"].isna()) & (panel["birthy2018"] != panel["birthy2016"]), "birth"] = panel["birthy2018"]

panel["age_2016"] = 2016 - panel["birth"]
panel["age_2018"] = 2018 - panel["birth"]

# 筛选18–29岁样本
panel = panel[(panel["age_2016"] >= 18) & (panel["age_2016"] <= 29)]

print("筛选后的样本数量：", len(panel))

# 婚姻状态变量
panel["married_2016"] = np.nan
panel.loc[panel["marital_status_2016"] == 2, "married_2016"] = 1
panel.loc[panel["marital_status_2016"].isin([1, 3, 4, 5]), "married_2016"] = 0

panel["married_2018"] = np.nan
panel.loc[panel["marital_status_2018"] == 2, "married_2018"] = 1
panel.loc[panel["marital_status_2018"].isin([1, 3, 4, 5]), "married_2018"] = 0

# 结婚年龄计算
panel["mage_2016"] = np.where(panel["married_2016"] == 1,
                              panel["mage_y_2016"] - panel["birth"], np.nan)
panel["mage_2018"] = np.where(panel["married_2018"] == 1,
                              panel["mage_y_2018"] - panel["birth"], np.nan)

# 检查异常值（<10或>100）
abnormal = panel[(panel["mage_2016"].between(10, 100) == False) |
                 (panel["mage_2018"].between(10, 100) == False)]
print("异常结婚年龄样本：")
print(abnormal[["pid", "mage_2016", "mage_2018"]])

# 最终保存结果
# panel.to_stata("/Users/wangzining/Desktop/CFPS/person/cfps_panel_final_2016_2018.dta", write_index=False)
panel.to_csv("/Users/wangzining/Desktop/CFPS/person/cfps_panel_final_2016_2018.csv", index=False, encoding="utf-8-sig")
```

# 文献复现

## （变量注释

- **sex**：性别  
- **health_16/18**：16/18年主观健康状况  
- **income_16/18**：16/18年个人总收入  
- **mage**：结婚年龄  
- **pos_emo_16/18**：16/18年积极情绪  
- **satisfaction_16/18**：16/18年生活满意度  

> 另：由于本次复现采用两期数据，采用的变量也是在原有基础上经过筛选得到，分析方法也较原文有不同，只进行了简单的回归分析，故数据结果与原文存在差异。

---

## 2016年数据回归分析

<center>

**模型摘要<sup>d</sup>**

</center>

| 模型 | R     | R 方 | 调整后 R 方 | 标准估算的错误 | R 方变化量 | F 变化量 | 自由度 1 | 自由度 2 | 显著性 F 变化量 |
|------|-------|------|-------------|----------------|------------|----------|----------|----------|----------------|
| 1    | .300<sup>a</sup> | .090 | .084        | 1.575          | .090       | 14.400   | 3        | 437      | .000           |
| 2    | .314<sup>b</sup> | .098 | .090        | 1.569          | .008       | 4.037    | 1        | 436      | .045           |
| 3    | .790<sup>c</sup> | .623 | .619        | 1.015          | .525       | 606.544  | 1        | 435      | .000           |

- <sup>a</sup> 预测变量：(常量), health_16, income_16, sex  
- <sup>b</sup> 预测变量：(常量), health_16, income_16, sex, mage  
- <sup>c</sup> 预测变量：(常量), health_16, income_16, sex, mage, pos_emo_16  
- <sup>d</sup> 因变量：satisfaction_16  

---

<center>

**ANOVA<sup>a</sup>**

</center>

| 模型 |        | 平方和   | 自由度 | 均方    | F        | 显著性     |
|------|--------|----------|--------|---------|----------|------------|
| 1    | 回归   | 107.157  | 3      | 35.719  | 14.400   | .000<sup>b</sup> |
|      | 残差   | 1083.945 | 437    | 2.480   |          |            |
|      | 总计   | 1191.102 | 440    |         |          |            |
| 2    | 回归   | 117.101  | 4      | 29.275  | 11.885   | .000<sup>c</sup> |
|      | 残差   | 1074.001 | 436    | 2.463   |          |            |
|      | 总计   | 1191.102 | 440    |         |          |            |
| 3    | 回归   | 742.546  | 5      | 148.509 | 144.021  | .000<sup>d</sup> |
|      | 残差   | 448.556  | 435    | 1.031   |          |            |
|      | 总计   | 1191.102 | 440    |         |          |            |

- <sup>a</sup> 因变量：satisfaction_16  
- <sup>b</sup> 预测变量：(常量), health_16, income_16, sex  
- <sup>c</sup> 预测变量：(常量), health_16, income_16, sex, mage  
- <sup>d</sup> 预测变量：(常量), health_16, income_16, sex, mage, pos_emo_16  

---

<center>

**系数<sup>a</sup>**

</center>

| 模型 | 变量        | B         | 标准错误 | Beta    | t        | 显著性 | 容差   | VIF    |
|------|-------------|-----------|----------|---------|----------|--------|--------|--------|
| 1    | (常量)      | 2.922     | .212     |         | 13.806   | .000   |        |        |
|      | sex         | -.458     | .157     | -.137   | -2.916   | .004   | .943   | 1.060  |
|      | income_16   | 2.157E-5  | .000     | .300    | 6.397    | .000   | .945   | 1.058  |
|      | health_16   | -.060     | .076     | -.036   | -.789    | .430   | .990   | 1.011  |
| 2    | (常量)      | 4.013     | .583     |         | 6.888    | .000   |        |        |
|      | sex         | -.428     | .157     | -.128   | -2.721   | .007   | .935   | 1.070  |
|      | income_16   | 2.264E-5  | .000     | .315    | 6.653    | .000   | .922   | 1.085  |
|      | health_16   | -.058     | .076     | -.035   | -.765    | .444   | .989   | 1.011  |
|      | mage        | -.051     | .025     | -.093   | -2.009   | .045   | .958   | 1.043  |
| 3    | (常量)      | 1.115     | .395     |         | 2.824    | .005   |        |        |
|      | sex         | -.307     | .102     | -.092   | -3.014   | .003   | .933   | 1.072  |
|      | income_16   | 6.978E-6  | .000     | .097    | 3.045    | .002   | .851   | 1.175  |
|      | health_16   | -.075     | .049     | -.045   | -1.529   | .127   | .989   | 1.011  |
|      | mage        | -.015     | .016     | -.028   | -.939    | .348   | .951   | 1.051  |
|      | pos_emo_16  | .917      | .037     | .755    | 24.628   | .000   | .920   | 1.086  |

- <sup>a</sup> 因变量：satisfaction_16  

---

## （2018年数据回归分析

<center>

**模型摘要<sup>d</sup>**

</center>

| 模型 | R     | R 方 | 调整后 R 方 | 标准估算的错误 | R 方变化量 | F 变化量 | 自由度 1 | 自由度 2 | 显著性 F 变化量 |
|------|-------|------|-------------|----------------|------------|----------|----------|----------|----------------|
| 1    | .061<sup>a</sup> | .004 | -.003       | 1.549          | .004       | .548     | 3        | 437      | .649           |
| 2    | .063<sup>b</sup> | .004 | -.005       | 1.551          | .000       | .094     | 1        | 436      | .760           |
| 3    | .733<sup>c</sup> | .538 | .533        | 1.057          | .534       | 502.772  | 1        | 435      | .000           |

- <sup>a</sup> 预测变量：(常量), health_18, income_18, sex  
- <sup>b</sup> 预测变量：(常量), health_18, income_18, sex, mage  
- <sup>c</sup> 预测变量：(常量), health_18, income_18, sex, mage, pos_emo_18  
- <sup>d</sup> 因变量：satisfaction_18  

---

<center>

**ANOVA<sup>a</sup>**

</center>

| 模型 |        | 平方和   | 自由度 | 均方    | F        | 显著性     |
|------|--------|----------|--------|---------|----------|------------|
| 1    | 回归   | 3.948    | 3      | 1.316   | .548     | .649<sup>b</sup> |
|      | 残差   | 1048.710 | 437    | 2.400   |          |            |
|      | 总计   | 1052.658 | 440    |         |          |            |
| 2    | 回归   | 4.173    | 4      | 1.043   | .434     | .784<sup>c</sup> |
|      | 残差   | 1048.485 | 436    | 2.405   |          |            |
|      | 总计   | 1052.658 | 440    |         |          |            |
| 3    | 回归   | 566.302  | 5      | 113.260 | 101.301  | .000<sup>d</sup> |
|      | 残差   | 486.356  | 435    | 1.118   |          |            |
|      | 总计   | 1052.658 | 440    |         |          |            |

- <sup>a</sup> 因变量：satisfaction_18  
- <sup>b</sup> 预测变量：(常量), health_18, income_18, sex  
- <sup>c</sup> 预测变量：(常量), health_18, income_18, sex, mage  
- <sup>d</sup> 预测变量：(常量), health_18, income_18, sex, mage, pos_emo_18  

---

<center>

**系数<sup>a</sup>**

</center>

| 模型 | 变量        | B         | 标准错误 | Beta    | t        | 显著性 | 容差   | VIF    |
|------|-------------|-----------|----------|---------|----------|--------|--------|--------|
| 1    | (常量)      | 3.367     | .201     |         | 16.737   | .000   |        |        |
|      | sex         | -.099     | .159     | -.032   | -.621    | .535   | .884   | 1.131  |
|      | income_18   | 2.641E-6  | .000     | .060    | 1.195    | .233   | .895   | 1.117  |
|      | health_18   | .020      | .068     | .014    | .295     | .768   | .985   | 1.016  |
| 2    | (常量)      | 3.207     | .561     |         | 5.719    | .000   |        |        |
|      | sex         | -.103     | .160     | -.033   | -.641    | .522   | .880   | 1.137  |
|      | income_18   | 2.485E-6  | .000     | .057    | 1.095    | .274   | .850   | 1.176  |
|      | health_18   | .017      | .069     | .012    | .243     | .808   | .960   | 1.041  |
|      | mage        | .008      | .026     | .015    | .306     | .760   | .908   | 1.102  |
| 3    | (常量)      | 1.589     | .389     |         | 4.084    | .000   |        |        |
|      | sex         | .014      | .109     | .004    | .127     | .899   | .878   | 1.139  |
|      | income_18   | 9.913E-7  | .000     | .023    | .640     | .522   | .849   | 1.178  |
|      | health_18   | -.021     | .047     | -.015   | -.451    | .652   | .959   | 1.043  |
|      | mage        | -.024     | .018     | -.046   | -1.345   | .179   | .902   | 1.109  |
|      | pos_emo_18  | .944      | .042     | .736    | 22.423   | .000   | .986   | 1.014  |

- <sup>a</sup> 因变量：satisfaction_18  